# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ö—ç—à-—Ç–∞–±–ª–∏—Ü—ã
## üìå –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ö–µ—à-—Ç–∞–±–ª–∏—Ü—ã –¥–ª—è —Å—Ç—Ä–æ–∫ —Å –∞–Ω–∞–ª–∏–∑–æ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏–π –∏ –º–µ—Ç–æ–¥–æ–≤ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

## üîç –ó–∞–¥–∞—á–∏

–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É—è —Ç—Ä–∏ –º–µ—Ç–æ–¥–∞:

- **–ß–∏—Å—Ç—ã–π –∞—Å—Å–µ–º–±–ª–µ—Ä** ‚Äî –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∫–ª—é—á–µ–≤—ã–µ —á–∞—Å—Ç–∏ –∫–æ–¥–∞ –Ω–∞ ASM.  
- **–ê—Å—Å–µ–º–±–ª–µ—Ä–Ω—ã–µ –≤—Å—Ç–∞–≤–∫–∏** ‚Äî —Ç–æ—á–µ—á–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.  
- **SIMD-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏** ‚Äî –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π (SSE/AVX).  

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä—ë–º –∞—Å—Å–µ–º–±–ª–µ—Ä–Ω–æ–≥–æ –∫–æ–¥–∞.  
- –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ:  

–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —É–ª—É—á—à–µ–Ω–∏—è = (–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —É—Å–∫–æ—Ä–µ–Ω–∏—è / –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Å—Å–µ–º–±–ª–µ—Ä–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π) * 1000

## üóÉÔ∏è –•–µ—à-—Ç–∞–±–ª–∏—Ü–∞ ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö 
###  üîç –ß—Ç–æ —ç—Ç–æ?
**–•–µ—à-—Ç–∞–±–ª–∏—Ü–∞** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –ø–æ –∫–ª—é—á—É. –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É:
–∫–ª—é—á ‚Üí —Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏—è ‚Üí –∏–Ω–¥–µ–∫—Å –≤ –º–∞—Å—Å–∏–≤–µ ‚Üí –∑–Ω–∞—á–µ–Ω–∏–µ

## –•–µ—à-—Ç–∞–±–ª–∏—Ü—ã: –ú–µ—Ç–æ–¥—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–ª–ª–∏–∑–∏–π üöÄ

–í —Ö–µ—à-—Ç–∞–±–ª–∏—Ü–∞—Ö –∫–æ–ª–ª–∏–∑–∏–∏ –Ω–µ–∏–∑–±–µ–∂–Ω—ã. –í–æ—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–∞ –∫ –∏—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—é:

‚ñå1. –ú–µ—Ç–æ–¥ —Ü–µ–ø–æ—á–µ–∫ (Separate Chaining) üîó

–ö–∞–∂–¥–∞—è —è—á–µ–π–∫–∞ –º–∞—Å—Å–∏–≤–∞ ‚Äî —ç—Ç–æ –≥–æ–ª–æ–≤–∞ —Å–≤—è–∑–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞. –ö–æ–≥–¥–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∫–æ–ª–ª–∏–∑–∏—è, –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫.

–ü–ª—é—Å—ã:

‚Ä¢   –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

‚Ä¢   –°—Ç–∞–±–∏–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–∞–∂–µ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ (–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ö–µ—à-—Ç–∞–±–ª–∏—Ü—ã).

–ú–∏–Ω—É—Å—ã:

‚Ä¢   –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å –Ω–∞ —É–∫–∞–∑–∞—Ç–µ–ª–∏ –¥–ª—è —Å–≤—è–∑–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤.

‚Ä¢   –í–æ–∑–º–æ–∂–Ω—ã–µ cache misses –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –ø–æ —Ä–∞–∑–Ω—ã–º —É—á–∞—Å—Ç–∫–∞–º –ø–∞–º—è—Ç–∏.

‚ñå2. –û—Ç–∫—Ä—ã—Ç–∞—è –∞–¥—Ä–µ—Å–∞—Ü–∏—è (Open Addressing) üö™

–í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ —Å–∞–º–æ–º –º–∞—Å—Å–∏–≤–µ. –ü—Ä–∏ –∫–æ–ª–ª–∏–∑–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–∏—Å–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–π —è—á–µ–π–∫–∏ –≤ –º–∞—Å—Å–∏–≤–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –ø–æ–º–æ—â—å—é –ª–∏–Ω–µ–π–Ω–æ–≥–æ –∏–ª–∏ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–≥–æ probing).

–ü–ª—é—Å—ã:

‚Ä¢   –õ—É—á—à–∞—è –ª–æ–∫–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö (–≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ä—è–¥–æ–º –≤ –ø–∞–º—è—Ç–∏).

‚Ä¢   –ú–µ–Ω—å—à–µ –∞–ª–ª–æ–∫–∞—Ü–∏–π –ø–∞–º—è—Ç–∏ (–Ω–µ –Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –∫–∞–∫ —Å–≤—è–∑–Ω—ã–µ —Å–ø–∏—Å–∫–∏).

–ú–∏–Ω—É—Å—ã:

‚Ä¢   –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü—ã –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 70%.

‚Ä¢   –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —É–¥–∞–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ —è—á–µ–π–∫–∞ –º–æ–≥–ª–∞ –±—ã—Ç—å "–∑–∞–Ω—è—Ç–∞" –¥—Ä—É–≥–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –∏–∑-–∑–∞ –∫–æ–ª–ª–∏–∑–∏–∏).


### üìä –ú–æ—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

–•—ç—à-—Ç–∞–±–ª–∏—Ü–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –º–µ—Ç–æ–¥–µ —Ü–µ–ø–æ—á–µ–∫ 

–†–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã: 5147 –±–∞–∫–µ—Ç–æ–≤ (–ø—Ä–æ—Å—Ç–æ–µ —á–∏—Å–ª–æ –¥–ª—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏).

–ö–ª—é—á–∏: –°—Ç—Ä–æ–∫–∏ –¥–æ 32 —Å–∏–º–≤–æ–ª–æ–≤ .

## üß™ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è (WSL)

–í—Å–µ –∑–∞–º–µ—Ä—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–∏—Å—å –≤ **WSL2 (Ubuntu 22.04)** –Ω–∞ Windows 11.

### üîß –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

- **–û–°**: Linux DESKTOP-LQJFIVQ 5.15.167.4-microsoft-standard-WSL2 x86_64 GNU/Linux
- **–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä**: 12th Gen Intel(R) Core(TM) i5-12450H @ 2.60GHz
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä/–ø–æ—Ç–æ–∫–æ–≤**: 12
- **–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å (RAM)**: 7.6 GiB
- **–§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞**: ext4 (–Ω–∞ `/dev/sdc`, —Å–≤–æ–±–æ–¥–Ω–æ 951 GB)

–≠—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ö—ç—à-—Ç–∞–±–ª–∏—Ü—ã.

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–ª–æ–≤
–î–ª—è –Ω–∞—á–∞–ª–∞ —É–±–µ—Ä–µ–º –ø—É–Ω–∫—Ç—É–∞—Ü–∏—é –∏ –ø–µ—Ä–µ–≤–µ–¥–µ–º –≤—Å–µ –±—É–∫–≤—ã –≤ —Å—Ç—Ä–æ—á–Ω—ã–µ  –æ—Ç–¥–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π (–ø–∞–ø–∫–∞ tools prepare_words.cpp), —á—Ç–æ–±—ã –∑–∞–º–µ—Ä—è—Ç—å –∏–º–µ–Ω–Ω–æ –ø–æ–∏—Å–∫.

## üî• –ù–∞—á–Ω–µ–º –∏—Å–∫–∞—Ç—å –≥–æ—Ä—è—á–∏–µ —Ç–æ—á–∫–∏

 –í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è valgrind –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è :

![–ü–µ—Ä–≤—ã–π –∑–∞–º–µ—Ä](callgrind/callgrind_1.png)

–í—ã–±—Ä–∞–≤ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –ø–æ Self, —É–≤–∏–¥–∏–º, —á—Ç–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Ç–∞–∫—Ç–æ–≤ (–±–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤) –∏–¥–µ—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é hash(), –µ–µ –∏ –±—É–¥–µ–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å.
### –ü–µ—Ä–≤–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

```c
unsigned long hash(const char *key)
{
    assert(key);

    unsigned long hash = 5381;

    for (size_t i = 0; key[i] != '\0'; i++)

         hash = ((hash << 5) + hash) + (size_t) (key[i]); // hash * 33 + c


    return hash;
}
```

–î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å  _mm_crc32_u64

```c
uint32_t hash_intrinsic(const char* word)
{
    uint64_t hash = 0;
    hash = _mm_crc32_u64(hash, *((const uint64_t*)(word)));     //process only 4 byte
    hash = _mm_crc32_u64(hash, *((const uint64_t*)(word + 8)));
    hash = _mm_crc32_u64(hash, *((const uint64_t*)(word + 16)));
    hash = _mm_crc32_u64(hash, *((const uint64_t*)(word + 24)));
    return (uint32_t)hash;
}
```
–û—Ü–µ–Ω–∏–≤–∞—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —É—Å–∫–æ—Ä–µ–Ω–∏—è –±—É–¥–µ–º –ø–æ —Ç–∞–∫—Ç–∞–º —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤, –ø–æ —Ç–∞–∫—Ç–∞–º —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∏—Å–∫–∞ –∏ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∏—Å–∫–∞

üîç –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Callgrind


| –§—É–Ω–∫—Ü–∏—è       | –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (—Ç–∞–∫—Ç—ã) | –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (—Ç–∞–∫—Ç—ã) | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|---------------|------------------------|----------------------------|-----------|
| `hash()`      | ~17.4 –º–ª—Ä–¥             | ~2.8 –º–ª—Ä–¥                 | **6.21x** |
| `search_word_table()` | ~48.7 –º–ª—Ä–¥        | ~34.5 –º–ª—Ä–¥                 | **1.41x** |

 ‚è±Ô∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (clock_gettime)

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|---------|----------------|--------------------|-----------|
| **–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è** | 1.23 ¬± 0.04 —Å–µ–∫ | 0.94 ¬± 0.01 —Å–µ–∫ | **1.31x** |


### –í—Ç–æ—Ä–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

![–í—Ç–æ—Ä–æ–π –∑–∞–º–µ—Ä](callgrind/callgrind_2.png)

–¢–µ–ø–µ—Ä—å —Å–∞–º–∞—è –¥–æ–ª–≥–∞—è strcmp, –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –µ–µ

–ó–∞–º–µ–Ω–∏–º –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é strcmp –Ω–∞ strcmp_avx2, –∏—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Ç—Ä–∏–Ω—Å–∏–∫–∏. –î–ª—è —ç—Ç–æ–≥–æ –≤  prepare_words.cpp –æ—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º —Å–ª–æ–≤–∞ –ø–æ 32 –±–∞–π—Ç–∞, —á—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å ymm —Ä–µ–≥–∏—Å—Ç—Ä—ã
```c
__attribute__((noinline))

int strcmp_avx2(const char *s1, const char *s2)
{
    assert(s1);
    assert(s2);

    const __m256i *ptr1 = (const __m256i*)s1;
    const __m256i *ptr2 = (const __m256i*)s2;

    __m256i vec1 = _mm256_load_si256(ptr1);
    __m256i vec2 = _mm256_load_si256(ptr2);

    uint32_t mask = _mm256_movemask_epi8(_mm256_cmpeq_epi8(vec1, vec2));
    return (mask == 0xFFFFFFFF) ? 0 : 1;
}

```

üîç –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Callgrind

| –§—É–Ω–∫—Ü–∏—è       | –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (—Ç–∞–∫—Ç—ã) | –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (—Ç–∞–∫—Ç—ã) | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|---------------|------------------------|----------------------------|-----------|
| `strcmp()`      | ~15.8 –º–ª—Ä–¥             | ~13.2 –º–ª—Ä–¥                 | **1.19x** |
| `search_word_table()` | ~34.5 –º–ª—Ä–¥          | ~30.4 –º–ª—Ä–¥                  | **1.14x** |


 ‚è±Ô∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (clock_gettime)


| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|---------|----------------|--------------------|-----------|
| **–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è** | 0.94¬±0.01 —Å–µ–∫ | 0.73¬±0.01 —Å–µ–∫ | **1.29x** |



### –¢—Ä–µ—Ç—å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

![–¢—Ä–µ—Ç–∏–π –∑–∞–º–µ—Ä](callgrind/callgrind_3.png)

–¢–µ–ø–µ—Ä—å —Å–∞–º–∞—è –¥–æ–ª–≥–∞—è —Ñ—É–Ω–∫—Ü–∏—è int search_word_table (HashTable *table, const char *word), –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –µ–µ –∏–Ω—Ç—Ä–∏–Ω—Å–∏–∫–∞–º–∏ .
```c

int search_word_table (HashTable *table, const char *word)
{

    assert(table);
    assert(word);

    unsigned long index = hash_intrinsic(word) % table->size;
    HashEntry *entry = table->buckets[index];

    while (entry)
    {
        if (strcmp_avx2(entry->word , word) == 0)
        {

            return entry->count;
        }

        if (entry->next)
            entry = entry->next;
        else
            break;
    }

    return HASH_NOT_FOUND_WORD;

}
```
```c
int search_word_table(HashTable *table, const char *word)
{
    assert(table);
    assert(word);

    unsigned long index = hash_intrinsic(word) % table->size;
    HashEntry *entry = table->buckets[index];

    // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –∏—Å–∫–æ–º–æ–µ —Å–ª–æ–≤–æ
    __m256i target = _mm256_loadu_si256((const __m256i *)word);

    while (entry)
    {
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ª–æ–≤–æ –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º
        __m256i current = _mm256_loadu_si256((const __m256i *)(entry->word));
        __m256i cmp = _mm256_cmpeq_epi8(current, target);
        int mask = _mm256_movemask_epi8(cmp);

        if (mask == 0xFFFFFFFF)
        {
            return entry->count;
        }

        entry = entry->next;
    }

    return HASH_NOT_FOUND_WORD;
}

```

üîç –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Callgrind

| –§—É–Ω–∫—Ü–∏—è       | –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏) | –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏) | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|---------------|-----------------------------|----------------------------------|-----------|
| `search_word_table()` | ~30.4 –º–ª—Ä–¥             | ~15.9 –º–ª—Ä–¥                      | **1.91x** |

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ Self –Ω–µ –±—É–¥–µ—Ç, —Ç–∞–∫ —Ç–∞–∫ –≤ Self –¥–æ–±–∞–≤–∏–ª–∞—Å—å —Ñ—É–Ω–∫—Ü–∏—è strcmp_avx2. –ê–Ω–∞–ª–∏–∑ –±—É–¥–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º


 ‚è±Ô∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (clock_gettime)

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|---------|----------------|--------------------|-----------|
| **–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è** | 0.73 ¬± 0.01 —Å–µ–∫ | 0.70 ¬± 0.01 —Å–µ–∫ | **1.03x** |

–ú—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –∂–µ–ª–∞–µ–º—ã—Ö 3—Ö –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ 

### –ß–µ—Ç–≤–µ—Ä—Ç–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

![–¢—Ä–µ—Ç–∏–π –∑–∞–º–µ—Ä](callgrind/callgrind_4.png)

